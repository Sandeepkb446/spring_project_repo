package com.sample.service;


import java.util.ArrayList;
import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.sample.entity.OrderItems;
import com.sample.entity.Orders;
import com.sample.repository.IOrderRepository;
import com.sample.request.OrderItemsRequest;
import com.sample.request.OrdersRequest;

@Service
public class ImplOrdesService implements IOrdersService {

	@Autowired
	IOrderRepository orderRepository;
	
	@Override
	public String createOrder(OrdersRequest request) {
		System.out.println("ImplOrdesService.createOrder()");
		Orders orders = new Orders();
		orders.setStatus(request.getStatus());
		
		List<OrderItemsRequest> requestitems = request.getItems();
		List<OrderItems> entryitems = new ArrayList<OrderItems>();
		
		for(OrderItemsRequest oir :requestitems) {
			OrderItems orderItems = new  OrderItems();
			
			orderItems.setItemName(oir.getItemName());
			orderItems.setPrice(oir.getPrice());
			orderItems.setQty(oir.getQty());
			
			entryitems.add(orderItems);
		}
		orders.setItems(entryitems);
		
		orderRepository.save(orders);
		
		return "Order Placed and the Order Id :  " + orders.getOrderId();
	}
	public String getOrderById(Integer id) {
		
		List<Orders> orderList = orderRepository.findAll();
		
		for(Orders o : orderList) {
			List<OrderItems> items = o.getItems();
			for(OrderItems oi : items) {
				System.out.println(oi.getItemName());
				System.out.println(oi.getOrderItemId());
			}
		}
		return "List : ";
	}
	
}
